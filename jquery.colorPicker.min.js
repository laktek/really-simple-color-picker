/**
 * Really Simple Color Picker in jQuery
 *
 * Licensed under the MIT (MIT-LICENSE.txt) licenses.
 *
 * Copyright (c) 2008-2012
 * Lakshan Perera (www.laktek.com) & Daniel Lacy (daniellacy.com)
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 */(function(e){var t,n,r=0,i={control:e('<div class="colorPicker-picker">&nbsp;</div>'),palette:e('<div id="colorPicker_palette" class="colorPicker-palette" />'),swatch:e('<div class="colorPicker-swatch">&nbsp;</div>'),hexLabel:e('<label for="colorPicker_hex">Hex</label>'),hexField:e('<input type="text" id="colorPicker_hex" />')},s="transparent",o;e.fn.colorPicker=function(t){return this.each(function(){var n=e(this),o=e.extend({},e.fn.colorPicker.defaults,t),u=e.fn.colorPicker.toHex(n.val().length>0?n.val():o.pickerDefault),a=i.control.clone(),f=i.palette.clone().attr("id","colorPicker_palette-"+r),l=i.hexLabel.clone(),c=i.hexField.clone(),h=f[0].id,p,d;e.each(o.colors,function(t){p=i.swatch.clone(),o.colors[t]===s?(p.addClass(s).text("X"),e.fn.colorPicker.bindPalette(c,p,s)):(p.css("background-color","#"+this),e.fn.colorPicker.bindPalette(c,p)),p.appendTo(f)}),l.attr("for","colorPicker_hex-"+r),c.attr({id:"colorPicker_hex-"+r,value:u}),c.bind("keydown",function(t){if(t.keyCode===13){var r=e.fn.colorPicker.toHex(e(this).val());e.fn.colorPicker.changeColor(r?r:n.val())}t.keyCode===27&&e.fn.colorPicker.hidePalette()}),c.bind("keyup",function(t){var r=e.fn.colorPicker.toHex(e(t.target).val());e.fn.colorPicker.previewColor(r?r:n.val())}),o.position==="top"?e('<div class="colorPicker_hexWrap" />').append(l).prependTo(f):e('<div class="colorPicker_hexWrap" />').append(l).appendTo(f),f.data("position",o.position),f.find(".colorPicker_hexWrap").append(c),o.showHexField===!1&&(c.hide(),l.hide()),e("body").append(f),f.hide(),a.css("background-color",u),a.bind("click",function(){n.is(":not(:disabled)")&&e.fn.colorPicker.togglePalette(e("#"+h),e(this))}),t&&t.onColorChange?a.data("onColorChange",t.onColorChange):a.data("onColorChange",function(){}),(d=n.data("text"))&&a.html(d),n.after(a),n.bind("change",function(){n.next(".colorPicker-picker").css("background-color",e.fn.colorPicker.toHex(e(this).val()))}),n.val(u);if(n[0].tagName.toLowerCase()==="input")try{n.attr("type","hidden")}catch(v){n.css("visibility","hidden").css("position","absolute")}else n.hide();r++})},e.extend(!0,e.fn.colorPicker,{toHex:function(e){if(e.match(/[0-9A-F]{6}|[0-9A-F]{3}$/i))return e.charAt(0)==="#"?e:"#"+e;if(!e.match(/^rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)$/))return!1;var t=[parseInt(RegExp.$1,10),parseInt(RegExp.$2,10),parseInt(RegExp.$3,10)],n=function(e){if(e.length<2)for(var t=0,n=2-e.length;t<n;t++)e="0"+e;return e};if(t.length===3){var r=n(t[0].toString(16)),i=n(t[1].toString(16)),s=n(t[2].toString(16));return"#"+r+i+s}},checkMouse:function(r,i){var s=n,o=e(r.target).parents("#"+s.attr("id")).length;if(r.target===e(s)[0]||r.target===t[0]||o>0)return;e.fn.colorPicker.hidePalette()},hidePalette:function(){e(document).unbind("mousedown",e.fn.colorPicker.checkMouse),e(".colorPicker-palette").hide()},showPalette:function(n){var r=t.prev("input").val(),i=n.data("position"),s,o;i==="top"?(s=t.offset().top-n.outerHeight(),o=t.offset().left):i==="left"?(s=t.offset().top,o=t.offset().left-n.outerWidth()):i==="right"?(s=t.offset().top,o=t.offset().left+t.outerWidth()):(s=t.offset().top+t.outerHeight(),o=t.offset().left),n.css({top:s,left:o}),e("#color_value").val(r),n.show(),e(document).bind("mousedown",e.fn.colorPicker.checkMouse)},togglePalette:function(r,i){i&&(t=i),n=r,n.is(":visible")?e.fn.colorPicker.hidePalette():e.fn.colorPicker.showPalette(r)},changeColor:function(n){t.css("background-color",n),t.prev("input").val(n).change(),e.fn.colorPicker.hidePalette(),t.data("onColorChange").call(t,e(t).prev("input").attr("id"),n)},previewColor:function(e){t.css("background-color",e)},bindPalette:function(n,r,i){i=i?i:e.fn.colorPicker.toHex(r.css("background-color")),r.bind({click:function(t){o=i,e.fn.colorPicker.changeColor(i)},mouseover:function(t){o=n.val(),e(this).css("border-color","#598FEF"),n.val(i),e.fn.colorPicker.previewColor(i)},mouseout:function(r){e(this).css("border-color","#000"),n.val(t.css("background-color")),n.val(o),e.fn.colorPicker.previewColor(o)}})}}),e.fn.colorPicker.defaults={pickerDefault:"FFFFFF",colors:["000000","993300","333300","000080","333399","333333","800000","FF6600","808000","008000","008080","0000FF","666699","808080","FF0000","FF9900","99CC00","339966","33CCCC","3366FF","800080","999999","FF00FF","FFCC00","FFFF00","00FF00","00FFFF","00CCFF","993366","C0C0C0","FF99CC","FFCC99","FFFF99","CCFFFF","99CCFF","FFFFFF"],addColors:[],showHexField:!0,position:"bottom"}})(jQuery);